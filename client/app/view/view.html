<div ng-hide="status.error" class="col-md-12" style="padding: 0px;">
    <div class="well" collapse="status.isViewlinkCollapsed" style="padding-left: 50px; position: absolute; top: 0px; left: 50px; width: 50%; height: 400px; background-color: white; z-index: 100;">
        <div style="text-align: right; padding-right: 50px; padding-top: 5px;">
            <button type="submit" class="btn btn-primary kfbutton" ng-click="createViewlink()">{{ 'close' | translate }}</button>
        </div>
        <label>{{ 'view_link' | translate }}</label>
        <ul>
            <li>{{ 'view_link_add_dragNdrop' | translate }}</li>
        </ul>
        <div style="height: 400px; overflow: scroll;">
            <div ng-repeat="view in views">
                <div viewlink style="white-space: nowrap;"><img draggable="false" src="manual_assets/kf4images/icon-view.gif"><a draggable="false" ng-href="view/{{view._id}}">{{view.title}}</a>
                </div>
            </div>
        </div>
    </div>
    <div class="well" collapse="status.isViewManagerCollapsed" style="padding-left: 50px; position: absolute; top: 0px; left: 50px; width: 50%; height: 400px; background-color: white; z-index: 100;">
        <div style="text-align: right; padding-right: 50px; padding-top: 5px;">
            <button type="submit" class="btn btn-primary kfbutton" ng-click="status.isViewManagerCollapsed = true;">{{ 'close' | translate }}</button>
        </div>
        <div style="height: 400px; overflow: scroll;">
            <div ng-include="'app/viewmanager/viewmanager.html'" ng-controller="ViewmanagerCtrl"></div>
        </div>
    </div>
    <div class="well" collapse="status.isAttachmentCollapsed" style="padding-left: 50px; position: absolute; top: 0px; left: 50px; width: 50%; background-color: white; z-index: 100;">
        <div style="text-align: right; padding-right: 50px; padding-top: 5px;">
            <button type="submit" class="btn btn-primary kfbutton" ng-click="status.isAttachmentCollapsed = true;">{{ 'close' | translate }}</button>
        </div>
        <div style="padding: 10px;">
            <div ng-include="'components/kfutils/attachmentuploader/attachmentuploader.html'"></div>
        </div>
    </div>
    <div class="well" collapse="status.isAnalyticsCollapsed" style="padding-left: 50px; position: absolute; top: 0px; left: 50px; width: 50%; background-color: white; z-index: 100;">
        <div style="text-align: right; padding-right: 50px; padding-top: 5px;">
            <button type="submit" class="btn btn-primary kfbutton" ng-click="status.isAnalyticsCollapsed = true">{{ 'close' | translate }}</button>
        </div>
        <div style="padding: 10px;">
            <label>{{ 'assessment_tools' | translate }} ({{ 'beta_version' | translate }}):</label>
            <ul>
                <li><a draggable="false" href="" ng-click="openTagCloud()">{{ 'assessment_tools_wordCloud' | translate }}</a></li>
                <li><a draggable="false" href="" ng-click="openActivityDashboard()">{{ 'activity_dashboard' | translate }}(beta)</a></li>
                <li><a draggable="false" href="" ng-click="openNoteDashboard()">{{'note_dashboard' | translate}}(beta)</a></li>
                <li><a draggable="false" href="" ng-click="openS2viz()">s2viz(beta)</a></li>
                <li><a draggable="false" href="" ng-click="openTimemashine()">{{'timemashine' | translate}}(beta)</a></li>
            </ul>
            <ul ng-if="context.data.plugins.lexicalanalysis === true">
                <li><a draggable="false" href="" ng-click="openLexicalAnalysis()"> Lexical Analysis</a></li>
            </ul>
            <ul ng-if="context.data.plugins.scaffoldgrowth === true">
                <li><a draggable="false" href="" ng-click="openScafoldSupportTracker()">Scaffold Growth</a></li>
            </ul>
        </div>
    </div>
    <div class="well" collapse="status.isSettingCollapsed" style="padding-left: 50px; position: absolute; top: 0px; left: 50px; width: 50%; background-color: white; z-index: 100;">
        <div style="text-align: right; padding-right: 50px; padding-top: 5px;">
            <button type="submit" class="btn btn-primary kfbutton" ng-click="status.isSettingCollapsed = true">{{ 'close' | translate }}</button>
        </div>
        <div>
            <label> Temporary View Setting: </label>
            <div style="padding: 10px;">
                <label>Connection showing:</label>
                <input type="checkbox" ng-model="setting.buildson" ng-change="settingChanged()">buildson
                <input type="checkbox" ng-model="setting.references" ng-change="settingChanged()">reference
                <br>
                <label>Label:</label>
                <input type="checkbox" ng-model="setting.showGroup" ng-change="settingChanged()">group
                <input type="checkbox" ng-model="setting.showAuthor" ng-change="settingChanged()">author
                <input type="checkbox" ng-model="setting.showTime" ng-change="settingChanged()">time
            </div>
        </div>
        <div>
            <label> Detailed View Setting: </label>
            <div style="padding: 20px;">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openViewSetting()"><img class="KFToolBarImage" src="manual_assets/kf6images/13-settings.png" title="Settings"></button>
            </div>
        </div>
        <div ng-show="isManager()">
            <label> Community Setting: </label>
            <div style="padding: 20px;">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openCommunitySetting()"><img class="KFToolBarImage" src="manual_assets/kf6images/13-settings.png" title="Settings"></button>
            </div>
        </div>
    </div>
    <div class="well" collapse="status.isHelpCollapsed" style="position: absolute; top: 60px; right: 55px; width: 50%; background-color: white; z-index: 100;">
        <div style="text-align: right; padding-right: 50px; padding-top: 5px;">
            <button type="submit" class="btn btn-primary kfbutton" ng-click="status.isHelpCollapsed = true;">{{ 'close' | translate }}</button>
        </div>
        <div style="overflow: scroll;">
            <div ng-include="'app/help/help.html'" ng-controller="HelpCtrl"></div>
        </div>
    </div>
    <div class="KFViewNavBar" ng-if="!menuStatus">
        <div class="KFCommunityTitle">{{community.community.title}}</div>
        <div class="KFViewTitle">{{view.title}}<span ng-show="!isEditable()"> (read only)</span>
        </div>
        <div class="KFUserName">{{community.author.getName()}} ({{community.author.role}})</div>
    </div>
    <div class='KFViewToolBar' ng-if="!menuStatus">
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="createNote()"><img class="KFToolBarImage" src="manual_assets/kf6images/01-toolbar-newwriting.png" title="{{ 'note_add' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="createDrawing()"><img class="KFToolBarImage" src="manual_assets/kf6images/02-toolbar-newdrawing.png" title="{{ 'drawing_add' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openAttachment()"><img class="KFToolBarImage" src="manual_assets/kf6images/03-toolbar-attachment.png" title="{{ 'attachments_add' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="status.isViewManagerCollapsed = !status.isViewManagerCollapsed;"><img class="KFToolBarImage" src="manual_assets/kf6images/04-toolbar-viewmanagement.png" title="{{ 'view_management' | translate }}"></button>
            </span>
        </span>
        <script type="text/ng-template" id="RiseaboveCreationModal.html">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">New RiseAbove</h3>
            </div>
            <div class="modal-body" id="modal-body">
                <label>Name:</label>
                <input type="text" class="form-control" ng-model="name"></input>
            </div>
            <div class="modal-footer">
                <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
                <button class="btn btn-primary" type="button" ng-click="ok()">Create</button>
            </div>
        </script>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openModal()"><img class="KFToolBarImage" src="manual_assets/kf6images/04X-toolbar-newriseabove.png" title="New RiseAbove"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="createViewlink()"><img class="KFToolBarImage" src="manual_assets/kf6images/05-toolbar-viewlink.png" title="{{ 'view_link_add' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openScaffolds();"><img class="KFToolBarImage" src="manual_assets/kf6images/06-toolbar-scaffolds.png" title="{{ 'scaffolds' | translate }}"></button>
            </span>
        </span>
        <span ng-show="isManager()" class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openAuthors();"><img class="KFToolBarImage" src="manual_assets/kf6images/11-user.png" title="{{ 'authors' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openGroups();"><img class="KFToolBarImage" src="manual_assets/kf6images/12-users.png" title="{{ 'groups' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openWorkspace()"><img class="KFToolBarImage" src="manual_assets/kf6images/07-toolbar-personalworkspace.png" title="{{ 'personal_workspace' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openSearch()"><img class="KFToolBarImage" src="manual_assets/kf6images/08-toolbar-search.png" title="{{ 'search' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="status.isSettingCollapsed = !status.isSettingCollapsed"><img class="" src="manual_assets/kf6images/13-settings.png" title="{{ 'settings' | translate }}"></button>
            </span>
        </span>
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openAnalytics()"><img class="KFToolBarImage" src="manual_assets/kf6images/analytics.png" title="{{ 'assessment_tools' | translate }}"></button>
            </span>
        </span>
        <!-- <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="openHelp()"><img class="KFToolBarImage" src="manual_assets/kf6images/09-toolbar-help.png" title="{{ 'help' | translate }}"></button>
            </span>
        </span> -->
        <span class="input-group">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary KFToolBarButton" ng-click="doExit()"><img class="KFToolBarImage" src="manual_assets/kf6images/10-toolbar-exit.png" title="{{ 'community_exit' | translate }}"></button>
            </span>
        </span>
    </div>
    <div ng-if="menuStatus !== 'X'" id="helpButton" class="KFViewRightBar" ng-click="status.isHelpCollapsed = !status.isHelpCollapsed">{{'help' | translate}}</div>
    <div id="maincanvas" class="KFViewMainCanvas">
        <div id="viewcanvas" class="KFViewContributionCanvas">
            <div ng-attr-id="{{ref._id}}" class="kfViewRef" ng-repeat="ref in refs" ng-style="{'top': ref.data.y, 'left': ref.data.x}" style="line-height: 100%;" ng-mousedown="mouseDown(this)" context-menu="onContextOpen(this)" data-target="menu-A">
                <div ng-if="ref.data.showInPlace!==true" style="white-space: nowrap; font-size: 12px;">
                    <div ng-if="ref._to.type !== 'View'">
                        <span ng-click="openContribution(ref.to, $event)" kf-refid="{{ref._id}}" ng-attr-class="icon{{ref.to}}">
                            <img ng-src="{{ref.getIcon()}}" draggable="false">
                        </span>
                        <a ng-click="openContribution(ref.to, $event)" class='kfIcon'>{{ref._to.title}}</a>
                        <br />
                        <span ng-if="setting.showGroup" style="font-size: 10px; color: #777777; white-space: nowrap;">
                            {{ref.getGroupString()}}
                        </span>
                        <span ng-if="setting.showAuthor" style="font-size: 10px; color: #777777; white-space: nowrap;">
                            {{ref.getAuthorString()}}
                        </span>
                        <span ng-if="setting.showGroup || setting.showAuthor"><br/></span>
                        <span ng-if="setting.showTime" class="KFTimeLabel">{{getTimeString(ref._to.modified)}}</span>
                    </div>
                    <div ng-if="ref._to.type === 'View'" style="white-space: nowrap;">
                        <span kf-refid="{{ref._id}}" ng-attr-class="icon{{ref.to}}">
                            <img ng-src="{{ref.getIcon()}}" draggable="false">
                        </span>
                        <a ng-click="openView(ref.to)" style="color: #0000FF;">{{ref._to.title}}</a>
                    </div>
                </div>
                <div ng-if="ref.data.showInPlace===true" ng-style="{'width': ref.data.width, 'height': ref.data.height}" kf-refid="{{ref._id}}" ng-attr-class="icon{{ref.to}}">
                    <div ng-if="ref._to.type === 'Drawing'" ng-bind-html="ref.contribution.data.svg"></div>
                    <div ng-if="ref._to.type === 'Attachment'">
                        <div ng-if="ref.contribution.data.type.indexOf('image/')>=0">
                            <img ng-attr-src="{{ref.contribution.data.url}}" ng-style="{'width': ref.data.width, 'height': ref.data.height}">
                        </div>
                        <div ng-if="ref.contribution.mime.indexOf('image/')<0">
                            <a ng-attr-href="{{ref.contribution.url}}">{{ref.contribution.title}}</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- for selection proxy-->
        <div id="selectioncanvas" class="KFViewSelectedCanvas"></div>
        <div id="dropcanvas" class="kfViewDropCanvas kfViewMarqueeCanvas" context-menu="canvasMenuOpen(this)" data-target="menu-Canvas"></div>
        <div id="windows" class="KFViewWindowsCanvas"></div>
    </div>

    <div class="dropdown position-fixed" id="menu-Canvas" style="position: absolute; z-index: 20;">
        <ul class="dropdown-menu" role="menu" style="font-size: 1.27em; min-width:13em;">
            <li ng-if="canvasMenu === null || !canvasMenu" class="menuitem unclickable" ng-click="">{{ 'paste' | translate }}</li>
            <li ng-if="canvasMenu !== null && canvasMenu" class="menuitem" ng-click="pasteNote($event)">{{ 'paste' | translate }}</li>
            <!-- <li class="menuitem ng-scope" ng-click="importNoteFromGoogle($event)">{{ 'Import from Google Drive' | translate }}</li> -->
        </ul>
    </div>

    <div class="dropdown position-fixed" id="menu-A" style="position: absolute; z-index: 20;">
        <ul class="dropdown-menu" role="menu" style="font-size: 1.27em; min-width:13em;">
            <li ng-if="contextTarget.data !== null && contextTarget._to.type !== 'View'" class="menuitem" ng-click="mOpenContribution()">{{ 'open' | translate }}</li>
            <li ng-if="contextTarget.data !== null && contextTarget._to.type !== 'View'" class="menuitem" ng-click="copy2Clipboard()">{{ 'copy' | translate }}</li>
            <li ng-if="contextTarget.data !== null && contextTarget._to.type !== 'View'" class="menuitem" ng-click="mOpenContributionInTab()">{{ 'openInTab' | translate }}</li>
            <li ng-if="contextTarget.data !== null && contextTarget._to.type !== 'View'" class="menuitem" ng-click="mOpenContributionInPopup()">{{ 'openInWindow' | translate }}</li>
            <li ng-if="contextTarget.data !== null && contextTarget._to.type === 'View'" class="menuitem" ng-click="mOpenView()">{{ 'open' | translate }}</li>
            <li ng-if="contextTarget.data !== null && contextTarget._to.type === 'View'" class="menuitem" ng-click="mOpenViewInInternal()">{{ 'openInInternal' | translate }}</li>
            <li ng-if="contextTarget.data !== null && contextTarget._to.type === 'View'" class="menuitem" ng-click="mOpenViewInPopup()">{{ 'openInWindow' | translate }}</li>
            <li ng-if="contextTarget.data.showInPlace === true && isEditable()" class="menuitem" ng-click="showAsIcon()">{{ 'show_as_icon' | translate }}</li>
            <li ng-if="contextTarget.data.showInPlace !== true && contextTarget._to.type !== 'Note' && isEditable()" class="menuitem" ng-click="showInPlace()">{{ 'show_in_place' | translate }}</li>
            <li ng-if="isFixable()" class="menuitem" ng-click="fix()">{{ 'position_fix' | translate }}</li>
            <li ng-if="isUnfixable()" class="menuitem" ng-click="unfix()">{{ 'position_unfix' | translate }}</li>
            <li ng-if="isLockable()" class="menuitem" ng-click="lock()">{{ 'object_lock' | translate }}</li>
            <!-- <li ng-if="isFixable() && isLockable()" class="menuitem" ng-click="fixAndLock()">{{ 'position_fixAndLock' | translate }}</li> -->
            <!-- <li ng-if="isUnfixable()" class="menuitem" ng-click="unfix()">{{ 'position_unfix' | translate }}</li> -->
            <li ng-if="isEditable()" class="menuitem" ng-click="createRiseaboveFromContextMenu()">{{ 'rise-above_create' | translate }}</li>
            <li ng-if="contextTarget.data !== null && isEditable() && isDeletable" class="menuitem" ng-click="delete()">{{ 'delete' | translate }}</li>
        </ul>
    </div>
</div>
<div ng-show="status.error">
    {{ 'error' | translate }}: {{status.errorMessage}}
</div>
